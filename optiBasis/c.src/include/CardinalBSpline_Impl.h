#pragma once

template <typename VALUETYPE, int ORDER>
CardinalBSpline<VALUETYPE, ORDER>::
CardinalBSpline (const ParamType & cc)
{
  VALUETYPE * ptr;
  ptr = aa[0];
  for (int ii = 0; ii < (ORDER+2) * ORDER; ++ii) {
    *(ptr++) = 0;
  }
  ptr = dd[0];
  for (int ii = 0; ii < (ORDER+2) * (ORDER-1); ++ii){
    *(ptr++) = 0;
  }
  init_value_coeffs ();
  init_deriv_coeffs ();
}

template <typename VALUETYPE, int ORDER>
void
CardinalBSpline<VALUETYPE, ORDER>::
init_value_coeffs () 
{
  switch (ORDER){
  case 2:
      aa[1+0][0] = 0.00000000000000000e+00;
      aa[1+0][1] = 1.00000000000000000e+00;

      aa[1+1][0] = 2.00000000000000000e+00;
      aa[1+1][1] = -1.00000000000000000e+00;

      break;
  case 3:
      aa[1+0][0] = 0.00000000000000000000000000000000e+00;
      aa[1+0][1] = 0.00000000000000000000000000000000e+00;
      aa[1+0][2] = 5.00000000000000000000000000000000e-01;

      aa[1+1][0] = -1.50000000000000000000000000000000e+00;
      aa[1+1][1] = 3.00000000000000000000000000000000e+00;
      aa[1+1][2] = -1.00000000000000000000000000000000e+00;

      aa[1+2][0] = 4.50000000000000000000000000000000e+00;
      aa[1+2][1] = -3.00000000000000000000000000000000e+00;
      aa[1+2][2] = 5.00000000000000000000000000000000e-01;
      break;
  case 4:
      aa[1+0][0] = 0.00000000000000000e+00;
      aa[1+0][1] = 0.00000000000000000e+00;
      aa[1+0][2] = 0.00000000000000000e+00;
      aa[1+0][3] = 1.66666666666666657e-01;

      aa[1+1][0] = 6.66666666666666630e-01;
      aa[1+1][1] = -2.00000000000000000e+00;
      aa[1+1][2] = 2.00000000000000000e+00;
      aa[1+1][3] = -5.00000000000000000e-01;

      aa[1+2][0] = -7.33333333333333304e+00;
      aa[1+2][1] = 1.00000000000000000e+01;
      aa[1+2][2] = -4.00000000000000000e+00;
      aa[1+2][3] = 5.00000000000000000e-01;

      aa[1+3][0] = 1.06666666666666661e+01;
      aa[1+3][1] = -8.00000000000000000e+00;
      aa[1+3][2] = 2.00000000000000000e+00;
      aa[1+3][3] = -1.66666666666666657e-01;

      break;
  case 6:
      aa[1+0][0] = 0.00000000000000000e+00;
      aa[1+0][1] = 0.00000000000000000e+00;
      aa[1+0][2] = 0.00000000000000000e+00;
      aa[1+0][3] = 0.00000000000000000e+00;
      aa[1+0][4] = 0.00000000000000000e+00;
      aa[1+0][5] = 8.33333333333333322e-03;

      aa[1+1][0] = 4.99999999999999958e-02;
      aa[1+1][1] = -2.49999999999999972e-01;
      aa[1+1][2] = 5.00000000000000000e-01;
      aa[1+1][3] = -5.00000000000000000e-01;
      aa[1+1][4] = 2.50000000000000000e-01;
      aa[1+1][5] = -4.16666666666666644e-02;

      aa[1+2][0] = -3.94999999999999973e+00;
      aa[1+2][1] = 9.75000000000000000e+00;
      aa[1+2][2] = -9.50000000000000000e+00;
      aa[1+2][3] = 4.50000000000000000e+00;
      aa[1+2][4] = -1.00000000000000000e+00;
      aa[1+2][5] = 8.33333333333333426e-02;

      aa[1+3][0] = 3.65499999999999972e+01;
      aa[1+3][1] = -5.77500000000000000e+01;
      aa[1+3][2] = 3.55000000000000000e+01;
      aa[1+3][3] = -1.05000000000000000e+01;
      aa[1+3][4] = 1.50000000000000000e+00;
      aa[1+3][5] = -8.33333333333333426e-02;

      aa[1+4][0] = -9.14499999999999886e+01;
      aa[1+4][1] = 1.02249999999999986e+02;
      aa[1+4][2] = -4.45000000000000000e+01;
      aa[1+4][3] = 9.50000000000000000e+00;
      aa[1+4][4] = -9.99999999999999889e-01;
      aa[1+4][5] = 4.16666666666666644e-02;

      aa[1+5][0] = 6.47999999999999972e+01;
      aa[1+5][1] = -5.39999999999999858e+01;
      aa[1+5][2] = 1.80000000000000000e+01;
      aa[1+5][3] = -3.00000000000000000e+00;
      aa[1+5][4] = 2.49999999999999972e-01;
      aa[1+5][5] = -8.33333333333333322e-03;

      break;
  case 8:
      aa[1+0][0] = 0.00000000000000000e+00;
      aa[1+0][1] = 0.00000000000000000e+00;
      aa[1+0][2] = 0.00000000000000000e+00;
      aa[1+0][3] = 0.00000000000000000e+00;
      aa[1+0][4] = 0.00000000000000000e+00;
      aa[1+0][5] = 0.00000000000000000e+00;
      aa[1+0][6] = 0.00000000000000000e+00;
      aa[1+0][7] = 1.98412698412698385e-04;

      aa[1+1][0] = 1.58730158730158708e-03;
      aa[1+1][1] = -1.11111111111111081e-02;
      aa[1+1][2] = 3.33333333333333329e-02;
      aa[1+1][3] = -5.55555555555555525e-02;
      aa[1+1][4] = 5.55555555555555525e-02;
      aa[1+1][5] = -3.33333333333333259e-02;
      aa[1+1][6] = 1.11111111111111098e-02;
      aa[1+1][7] = -1.38888888888888873e-03;

      aa[1+2][0] = -7.09523809523809557e-01;
      aa[1+2][1] = 2.47777777777777786e+00;
      aa[1+2][2] = -3.69999999999999973e+00;
      aa[1+2][3] = 3.05555555555555536e+00;
      aa[1+2][4] = -1.50000000000000000e+00;
      aa[1+2][5] = 4.33333333333333293e-01;
      aa[1+2][6] = -6.66666666666666519e-02;
      aa[1+2][7] = 4.16666666666666661e-03;

      aa[1+3][0] = 2.35904761904761919e+01;
      aa[1+3][1] = -5.42222222222222285e+01;
      aa[1+3][2] = 5.30000000000000000e+01;
      aa[1+3][3] = -2.84444444444444429e+01;
      aa[1+3][4] = 8.99999999999999822e+00;
      aa[1+3][5] = -1.66666666666666652e+00;
      aa[1+3][6] = 1.66666666666666657e-01;
      aa[1+3][7] = -6.94444444444444406e-03;

      aa[1+4][0] = -2.03965079365079362e+02;
      aa[1+4][1] = 3.44000000000000057e+02;
      aa[1+4][2] = -2.45666666666666686e+02;
      aa[1+4][3] = 9.60000000000000000e+01;
      aa[1+4][4] = -2.21111111111111107e+01;
      aa[1+4][5] = 3.00000000000000000e+00;
      aa[1+4][6] = -2.22222222222222210e-01;
      aa[1+4][7] = 6.94444444444444406e-03;

      aa[1+5][0] = 6.64090476190476352e+02;
      aa[1+5][1] = -8.71277777777777601e+02;
      aa[1+5][2] = 4.83499999999999943e+02;
      aa[1+5][3] = -1.47055555555555543e+02;
      aa[1+5][4] = 2.64999999999999964e+01;
      aa[1+5][5] = -2.83333333333333304e+00;
      aa[1+5][6] = 1.66666666666666630e-01;
      aa[1+5][7] = -4.16666666666666661e-03;

      aa[1+6][0] = -8.91109523809523580e+02;
      aa[1+6][1] = 9.43122222222222035e+02;
      aa[1+6][2] = -4.23699999999999932e+02;
      aa[1+6][3] = 1.04944444444444414e+02;
      aa[1+6][4] = -1.54999999999999964e+01;
      aa[1+6][5] = 1.36666666666666647e+00;
      aa[1+6][6] = -6.66666666666666519e-02;
      aa[1+6][7] = 1.38888888888888873e-03;

      aa[1+7][0] = 4.16101587301587244e+02;
      aa[1+7][1] = -3.64088888888888846e+02;
      aa[1+7][2] = 1.36533333333333303e+02;
      aa[1+7][3] = -2.84444444444444393e+01;
      aa[1+7][4] = 3.55555555555555536e+00;
      aa[1+7][5] = -2.66666666666666607e-01;
      aa[1+7][6] = 1.11111111111111081e-02;
      aa[1+7][7] = -1.98412698412698385e-04;

      break;
  case 10:
      aa[1+0][0] = 0.00000000000000000e+00;
      aa[1+0][1] = 0.00000000000000000e+00;
      aa[1+0][2] = 0.00000000000000000e+00;
      aa[1+0][3] = 0.00000000000000000e+00;
      aa[1+0][4] = 0.00000000000000000e+00;
      aa[1+0][5] = 0.00000000000000000e+00;
      aa[1+0][6] = 0.00000000000000000e+00;
      aa[1+0][7] = 0.00000000000000000e+00;
      aa[1+0][8] = 0.00000000000000000e+00;
      aa[1+0][9] = 2.75573192239858840e-06;

      aa[1+1][0] = 2.75573192239858891e-05;
      aa[1+1][1] = -2.48015873015873002e-04;
      aa[1+1][2] = 9.92063492063492008e-04;
      aa[1+1][3] = -2.31481481481481469e-03;
      aa[1+1][4] = 3.47222222222222116e-03;
      aa[1+1][5] = -3.47222222222222203e-03;
      aa[1+1][6] = 2.31481481481481425e-03;
      aa[1+1][7] = -9.92063492063491792e-04;
      aa[1+1][8] = 2.48015873015872948e-04;
      aa[1+1][9] = -2.48015873015872948e-05;

      aa[1+2][0] = -6.34645061728394966e-02;
      aa[1+2][1] = 2.85466269841269826e-01;
      aa[1+2][2] = -5.70436507936507797e-01;
      aa[1+2][3] = 6.64351851851851749e-01;
      aa[1+2][4] = -4.96527777777777735e-01;
      aa[1+2][5] = 2.46527777777777735e-01;
      aa[1+2][6] = -8.10185185185185175e-02;
      aa[1+2][7] = 1.68650793650793607e-02;
      aa[1+2][8] = -1.98412698412698358e-03;
      aa[1+2][9] = 9.92063492063491792e-05;

      aa[1+3][0] = 6.44546406525573090e+00;
      aa[1+3][1] = -1.92413194444444464e+01;
      aa[1+3][2] = 2.54652777777777786e+01;
      aa[1+3][3] = -1.95856481481481488e+01;
      aa[1+3][4] = 9.62847222222222143e+00;
      aa[1+3][5] = -3.12847222222222232e+00;
      aa[1+3][6] = 6.68981481481481399e-01;
      aa[1+3][7] = -9.02777777777777624e-02;
      aa[1+3][8] = 6.94444444444444406e-03;
      aa[1+3][9] = -2.31481481481481436e-04;

      aa[1+4][0] = -1.45258239638447975e+02;
      aa[1+4][1] = 3.22092013888888857e+02;
      aa[1+4][2] = -3.15868055555555543e+02;
      aa[1+4][3] = 1.79525462962962962e+02;
      aa[1+4][4] = -6.50381944444444429e+01;
      aa[1+4][5] = 1.55381944444444429e+01;
      aa[1+4][6] = -2.44212962962962976e+00;
      aa[1+4][7] = 2.43055555555555525e-01;
      aa[1+4][8] = -1.38888888888888881e-02;
      aa[1+4][9] = 3.47222222222222181e-04;

      aa[1+5][0] = 1.21107856591710743e+03;
      aa[1+5][1] = -2.11931423611111086e+03;
      aa[1+5][2] = 1.63725694444444434e+03;
      aa[1+5][3] = -7.31932870370370210e+02;
      aa[1+5][4] = 2.08399305555555543e+02;
      aa[1+5][5] = -3.91493055555555500e+01;
      aa[1+5][6] = 4.84953703703703720e+00;
      aa[1+5][7] = -3.81944444444444420e-01;
      aa[1+5][8] = 1.73611111111111084e-02;
      aa[1+5][9] = -3.47222222222222181e-04;

      aa[1+6][0] = -4.62092143408289303e+03;
      aa[1+6][1] = 6.62868576388888869e+03;
      aa[1+6][2] = -4.19474305555555566e+03;
      aa[1+6][3] = 1.53606712962962979e+03;
      aa[1+6][4] = -3.58600694444444400e+02;
      aa[1+6][5] = 5.53506944444444429e+01;
      aa[1+6][6] = -5.65046296296296280e+00;
      aa[1+6][7] = 3.68055555555555525e-01;
      aa[1+6][8] = -1.38888888888888864e-02;
      aa[1+6][9] = 2.31481481481481436e-04;

      aa[1+7][0] = 8.72352532517636610e+03;
      aa[1+7][1] = -1.05284600694444416e+04;
      aa[1+7][2] = 5.60934027777777737e+03;
      aa[1+7][3] = -1.73196064814814781e+03;
      aa[1+7][4] = 3.41690972222222172e+02;
      aa[1+7][5] = -4.46909722222222143e+01;
      aa[1+7][6] = 3.87731481481481444e+00;
      aa[1+7][7] = -2.15277777777777707e-01;
      aa[1+7][8] = 6.94444444444444232e-03;
      aa[1+7][9] = -9.92063492063491792e-05;

      aa[1+8][0] = -7.92053816688712413e+03;
      aa[1+8][1] = 8.19611135912698228e+03;
      aa[1+8][2] = -3.75294543650793594e+03;
      aa[1+8][3] = 9.98706018518518363e+02;
      aa[1+8][4] = -1.70309027777777715e+02;
      aa[1+8][5] = 1.93090277777777750e+01;
      aa[1+8][6] = -1.45601851851851816e+00;
      aa[1+8][7] = 7.04365079365079083e-02;
      aa[1+8][8] = -1.98412698412698358e-03;
      aa[1+8][9] = 2.48015873015872948e-05;

      aa[1+9][0] = 2.75573192239858872e+03;
      aa[1+9][1] = -2.48015873015873058e+03;
      aa[1+9][2] = 9.92063492063491935e+02;
      aa[1+9][3] = -2.31481481481481438e+02;
      aa[1+9][4] = 3.47222222222222143e+01;
      aa[1+9][5] = -3.47222222222222232e+00;
      aa[1+9][6] = 2.31481481481481455e-01;
      aa[1+9][7] = -9.92063492063491661e-03;
      aa[1+9][8] = 2.48015873015873002e-04;
      aa[1+9][9] = -2.75573192239858840e-06;

      break;
  case 12:
      aa[1+0][0] = 0.00000000000000000e+00;
      aa[1+0][1] = 0.00000000000000000e+00;
      aa[1+0][2] = 0.00000000000000000e+00;
      aa[1+0][3] = 0.00000000000000000e+00;
      aa[1+0][4] = 0.00000000000000000e+00;
      aa[1+0][5] = 0.00000000000000000e+00;
      aa[1+0][6] = 0.00000000000000000e+00;
      aa[1+0][7] = 0.00000000000000000e+00;
      aa[1+0][8] = 0.00000000000000000e+00;
      aa[1+0][9] = 0.00000000000000000e+00;
      aa[1+0][10] = 0.00000000000000000e+00;
      aa[1+0][11] = 2.50521083854417136e-08;

      aa[1+1][0] = 3.00625300625300537e-07;
      aa[1+1][1] = -3.30687830687830575e-06;
      aa[1+1][2] = 1.65343915343915287e-05;
      aa[1+1][3] = -4.96031746031745828e-05;
      aa[1+1][4] = 9.92063492063491792e-05;
      aa[1+1][5] = -1.38888888888888862e-04;
      aa[1+1][6] = 1.38888888888888862e-04;
      aa[1+1][7] = -9.92063492063492063e-05;
      aa[1+1][8] = 4.96031746031745896e-05;
      aa[1+1][9] = -1.65343915343915287e-05;
      aa[1+1][10] = 3.30687830687830617e-06;
      aa[1+1][11] = -2.75573192239858830e-07;

      aa[1+2][0] = -3.38594276094276005e-03;
      aa[1+2][1] = 1.86210317460317396e-02;
      aa[1+2][2] = -4.65443121693121659e-02;
      aa[1+2][3] = 6.97916666666666546e-02;
      aa[1+2][4] = -6.97420634920634802e-02;
      aa[1+2][5] = 4.87499999999999878e-02;
      aa[1+2][6] = -2.43055555555555490e-02;
      aa[1+2][7] = 8.63095238095237804e-03;
      aa[1+2][8] = -2.13293650793650773e-03;
      aa[1+2][9] = 3.47222222222222127e-04;
      aa[1+2][10] = -3.30687830687830575e-05;
      aa[1+2][11] = 1.37786596119929420e-06;

      aa[1+3][0] = 9.72953342953342792e-01;
      aa[1+3][1] = -3.56128968253968159e+00;
      aa[1+3][2] = 5.91997354497354422e+00;
      aa[1+3][3] = -5.89672619047618873e+00;
      aa[1+3][4] = 3.90793650793650738e+00;
      aa[1+3][5] = -1.80749999999999966e+00;
      aa[1+3][6] = 5.94444444444444331e-01;
      aa[1+3][7] = -1.38690476190476197e-01;
      aa[1+3][8] = 2.24206349206349173e-02;
      aa[1+3][9] = -2.38095238095238030e-03;
      aa[1+3][10] = 1.48809523809523796e-04;
      aa[1+3][11] = -4.13359788359788303e-06;

      aa[1+4][0] = -5.10397450697450594e+01;
      aa[1+4][1] = 1.39473630952380915e+02;
      aa[1+4][2] = -1.72873677248677211e+02;
      aa[1+4][3] = 1.28198511904761887e+02;
      aa[1+4][4] = -6.31396825396825321e+01;
      aa[1+4][5] = 2.16591666666666640e+01;
      aa[1+4][6] = -5.27222222222222214e+00;
      aa[1+4][7] = 9.08928571428571308e-01;
      aa[1+4][8] = -1.08531746031746021e-01;
      aa[1+4][9] = 8.53174603174603093e-03;
      aa[1+4][10] = -3.96825396825396825e-04;
      aa[1+4][11] = 8.26719576719576606e-06;

      aa[1+5][0] = 9.17772258898508767e+02;
      aa[1+5][1] = -1.99191277777777759e+03;
      aa[1+5][2] = 1.95851273148148130e+03;
      aa[1+5][3] = -1.15063333333333321e+03;
      aa[1+5][4] = 4.48393055555555634e+02;
      aa[1+5][5] = -1.21569999999999993e+02;
      aa[1+5][6] = 2.33736111111111100e+01;
      aa[1+5][7] = -3.18333333333333357e+00;
      aa[1+5][8] = 3.00694444444444431e-01;
      aa[1+5][9] = -1.87500000000000028e-02;
      aa[1+5][10] = 6.94444444444444471e-04;
      aa[1+5][11] = -1.15740740740740735e-05;

      aa[1+6][0] = -7.48030774110149105e+03;
      aa[1+6][1] = 1.34045672222222202e+04;
      aa[1+6][2] = -1.08718872685185197e+04;
      aa[1+6][3] = 5.26456666666666570e+03;
      aa[1+6][4] = -1.69000694444444457e+03;
      aa[1+6][5] = 3.77389999999999930e+02;
      aa[1+6][6] = -5.97863888888888795e+01;
      aa[1+6][7] = 6.71666666666666679e+00;
      aa[1+6][8] = -5.24305555555555580e-01;
      aa[1+6][9] = 2.70833333333333273e-02;
      aa[1+6][10] = -8.33333333333333278e-04;
      aa[1+6][11] = 1.15740740740740735e-05;

      aa[1+7][0] = 3.17523657311207280e+04;
      aa[1+7][1] = -4.82467768055555425e+04;
      aa[1+7][2] = 3.31647870370370365e+04;
      aa[1+7][3] = -1.36082937500000007e+04;
      aa[1+7][4] = 3.70223888888888860e+03;
      aa[1+7][5] = -7.01059166666666670e+02;
      aa[1+7][6] = 9.42777777777777857e+01;
      aa[1+7][7] = -9.00416666666666821e+00;
      aa[1+7][8] = 5.98611111111111094e-01;
      aa[1+7][9] = -2.63888888888888853e-02;
      aa[1+7][10] = 6.94444444444444363e-04;
      aa[1+7][11] = -8.26719576719576606e-06;

      aa[1+8][0] = -7.47696406180856138e+04;
      aa[1+8][1] = 9.82209819246031839e+04;
      aa[1+8][2] = -5.83775621693121648e+04;
      aa[1+8][3] = 2.07200872023809534e+04;
      aa[1+8][4] = -4.87985634920634948e+03;
      aa[1+8][5] = 8.00807499999999891e+02;
      aa[1+8][6] = -9.34555555555555486e+01;
      aa[1+8][7] = 7.75773809523809454e+00;
      aa[1+8][8] = -4.49007936507936467e-01;
      aa[1+8][9] = 1.72619047619047596e-02;
      aa[1+8][10] = -3.96825396825396771e-04;
      aa[1+8][11] = 4.13359788359788303e-06;

      aa[1+9][0] = 9.81859348283429572e+04;
      aa[1+9][1] = -1.13169165843253970e+05;
      aa[1+9][2] = 5.90614088128306830e+04;
      aa[1+9][3] = -1.84262364583333328e+04;
      aa[1+9][4] = 3.81932668650793539e+03;
      aa[1+9][5] = -5.52398749999999836e+02;
      aa[1+9][6] = 5.69006944444444400e+01;
      aa[1+9][7] = -4.17529761904761809e+00;
      aa[1+9][8] = 2.13938492063491997e-01;
      aa[1+9][9] = -7.29166666666666505e-03;
      aa[1+9][10] = 1.48809523809523769e-04;
      aa[1+9][11] = -1.37786596119929420e-06;

      aa[1+10][0] = -6.71579805155723589e+04;
      aa[1+10][1] = 6.87091410350528895e+04;
      aa[1+10][2] = -3.18777446263227466e+04;
      aa[1+10][3] = 8.85550957341269532e+03;
      aa[1+10][4] = -1.63702251984126929e+03;
      aa[1+10][5] = 2.11490138888888850e+02;
      aa[1+10][6] = -1.94881944444444422e+01;
      aa[1+10][7] = 1.28105158730158708e+00;
      aa[1+10][8] = -5.88789682539682321e-02;
      aa[1+10][9] = 1.80224867724867685e-03;
      aa[1+10][10] = -3.30687830687830710e-05;
      aa[1+10][11] = 2.75573192239858830e-07;

      aa[1+11][0] = 1.86139262337662403e+04;
      aa[1+11][1] = -1.70627657142857133e+04;
      aa[1+11][2] = 7.10948571428571449e+03;
      aa[1+11][3] = -1.77737142857142862e+03;
      aa[1+11][4] = 2.96228571428571399e+02;
      aa[1+11][5] = -3.45600000000000023e+01;
      aa[1+11][6] = 2.87999999999999989e+00;
      aa[1+11][7] = -1.71428571428571402e-01;
      aa[1+11][8] = 7.14285714285714177e-03;
      aa[1+11][9] = -1.98412698412698385e-04;
      aa[1+11][10] = 3.30687830687830702e-06;
      aa[1+11][11] = -2.50521083854417136e-08;

      break;
  case 14:
      aa[1+0][0] = 0.00000000000000000e+00;
      aa[1+0][1] = 0.00000000000000000e+00;
      aa[1+0][2] = 0.00000000000000000e+00;
      aa[1+0][3] = 0.00000000000000000e+00;
      aa[1+0][4] = 0.00000000000000000e+00;
      aa[1+0][5] = 0.00000000000000000e+00;
      aa[1+0][6] = 0.00000000000000000e+00;
      aa[1+0][7] = 0.00000000000000000e+00;
      aa[1+0][8] = 0.00000000000000000e+00;
      aa[1+0][9] = 0.00000000000000000e+00;
      aa[1+0][10] = 0.00000000000000000e+00;
      aa[1+0][11] = 0.00000000000000000e+00;
      aa[1+0][12] = 0.00000000000000000e+00;
      aa[1+0][13] = 1.60590438368216108e-10;

      aa[1+1][0] = 2.24826613715502509e-09;
      aa[1+1][1] = -2.92274597830153270e-08;
      aa[1+1][2] = 1.75364758698091975e-07;
      aa[1+1][3] = -6.43004115226337287e-07;
      aa[1+1][4] = 1.60751028806584317e-06;
      aa[1+1][5] = -2.89351851851851795e-06;
      aa[1+1][6] = 3.85802469135802309e-06;
      aa[1+1][7] = -3.85802469135802394e-06;
      aa[1+1][8] = 2.89351851851851795e-06;
      aa[1+1][9] = -1.60751028806584317e-06;
      aa[1+1][10] = 6.43004115226337287e-07;
      aa[1+1][11] = -1.75364758698091975e-07;
      aa[1+1][12] = 2.92274597830153336e-08;
      aa[1+1][13] = -2.08767569878680919e-09;

      aa[1+2][0] = -1.19713427005093621e-04;
      aa[1+2][1] = 7.78122661803217169e-04;
      aa[1+2][2] = -2.33428030303030288e-03;
      aa[1+2][3] = 4.27919238683127385e-03;
      aa[1+2][4] = -5.34818672839506085e-03;
      aa[1+2][5] = 4.81192129629629504e-03;
      aa[1+2][6] = -3.20601851851851777e-03;
      aa[1+2][7] = 1.60108024691357981e-03;
      aa[1+2][8] = -5.98958333333333287e-04;
      aa[1+2][9] = 1.65573559670781855e-04;
      aa[1+2][10] = -3.27932098765432034e-05;
      aa[1+2][11] = 4.38411896745229946e-06;
      aa[1+2][12] = -3.50729517396183951e-07;
      aa[1+2][13] = 1.25260541927208568e-08;

      aa[1+3][0] = 9.30763093002675984e-02;
      aa[1+3][1] = -4.03071309156378454e-01;
      aa[1+3][2] = 8.05364583333332940e-01;
      aa[1+3][3] = -9.82908307613168497e-01;
      aa[1+3][4] = 8.17308063271604768e-01;
      aa[1+3][5] = -4.88781828703703569e-01;
      aa[1+3][6] = 2.16168981481481448e-01;
      aa[1+3][7] = -7.15239197530864040e-02;
      aa[1+3][8] = 1.76822916666666621e-02;
      aa[1+3][9] = -3.21984310699588439e-03;
      aa[1+3][10] = 4.18595679012345604e-04;
      aa[1+3][11] = -3.66512345679012206e-05;
      aa[1+3][12] = 1.92901234567901197e-06;
      aa[1+3][13] = -4.59288653733098072e-08;

      aa[1+4][0] = -1.06947426207408807e+01;
      aa[1+4][1] = 3.46573402134773545e+01;
      aa[1+4][2] = -5.17852527006172707e+01;
      aa[1+4][3] = 4.72251575360082185e+01;
      aa[1+4][4] = -2.93127330889917666e+01;
      aa[1+4][5] = 1.30697366898148122e+01;
      aa[1+4][6] = -4.30333719135802362e+00;
      aa[1+4][7] = 1.05835262345678993e+00;
      aa[1+4][8] = -1.94169560185185164e-01;
      aa[1+4][9] = 2.62040252057613131e-02;
      aa[1+4][10] = -2.52379115226337384e-03;
      aa[1+4][11] = 1.63966049382716024e-04;
      aa[1+4][12] = -6.43004115226337351e-06;
      aa[1+4][13] = 1.14822163433274534e-07;

      aa[1+5][0] = 3.81763823801584181e+02;
      aa[1+5][1] = -9.85734932484567594e+02;
      aa[1+5][2] = 1.17268547453703695e+03;
      aa[1+5][3] = -8.50720042438271435e+02;
      aa[1+5][4] = 4.19659866898148039e+02;
      aa[1+5][5] = -1.48560399305555507e+02;
      aa[1+5][6] = 3.87980324074074048e+01;
      aa[1+5][7] = -7.56192129629629584e+00;
      aa[1+5][8] = 1.09887152777777741e+00;
      aa[1+5][9] = -1.17467206790123430e-01;
      aa[1+5][10] = 8.96990740740740561e-03;
      aa[1+5][11] = -4.62962962962962926e-04;
      aa[1+5][12] = 1.44675925925925898e-05;
      aa[1+5][13] = -2.06679894179894162e-07;

      aa[1+6][0] = -5.91679617619841429e+03;
      aa[1+6][1] = 1.26611450675154301e+04;
      aa[1+6][2] = -1.24741945254629591e+04;
      aa[1+6][3] = 7.48903995756172753e+03;
      aa[1+6][4] = -3.05524013310185092e+03;
      aa[1+6][5] = 8.93909600694444407e+02;
      aa[1+6][6] = -1.92861967592592606e+02;
      aa[1+6][7] = 3.10480787037036983e+01;
      aa[1+6][8] = -3.72737847222222163e+00;
      aa[1+6][9] = 3.29407793209876454e-01;
      aa[1+6][10] = -2.08217592592592551e-02;
      aa[1+6][11] = 8.91203703703703732e-04;
      aa[1+6][12] = -2.31481481481481436e-05;
      aa[1+6][13] = 2.75573192239858883e-07;

      aa[1+7][0] = 4.74832316054373732e+04;
      aa[1+7][1] = -8.65103350983796117e+04;
      aa[1+7][2] = 7.25299313310184953e+04;
      aa[1+7][3] = -3.70369307291666628e+04;
      aa[1+7][4] = 1.28468922550154275e+04;
      aa[1+7][5] = -3.19521015624999882e+03;
      aa[1+7][6] = 5.86017986111110986e+02;
      aa[1+7][7] = -8.02204861111111143e+01;
      aa[1+7][8] = 8.19425347222222200e+00;
      aa[1+7][9] = -6.16753472222222210e-01;
      aa[1+7][10] = 3.32445987654320999e-02;
      aa[1+7][11] = -1.21527777777777780e-03;
      aa[1+7][12] = 2.70061728395061743e-05;
      aa[1+7][13] = -2.75573192239858883e-07;

      aa[1+8][0] = -2.17638206419253896e+05;
      aa[1+8][1] = 3.44312001691743673e+05;
      aa[1+8][2] = -2.50586821261573990e+05;
      aa[1+8][3] = 1.11058247542438257e+05;
      aa[1+8][4] = -3.34328509548611037e+04;
      aa[1+8][5] = 7.21773206597222088e+03;
      aa[1+8][6] = -1.14947238425925889e+03;
      aa[1+8][7] = 1.36715810185185177e+02;
      aa[1+8][8] = -1.21435243055555553e+01;
      aa[1+8][9] = 7.95592206790123546e-01;
      aa[1+8][10] = -3.73726851851851824e-02;
      aa[1+8][11] = 1.19212962962962936e-03;
      aa[1+8][12] = -2.31481481481481436e-05;
      aa[1+8][13] = 2.06679894179894162e-07;

      aa[1+9][0] = 5.99576887565121055e+05;
      aa[1+9][1] = -8.36109800730131101e+05;
      aa[1+9][2] = 5.36361047019675840e+05;
      aa[1+9][3] = -2.09550143238811754e+05;
      aa[1+9][4] = 5.56250353732639051e+04;
      aa[1+9][5] = -1.05938451996527783e+04;
      aa[1+9][6] = 1.48927980324074065e+03;
      aa[1+9][7] = -1.56478877314814838e+02;
      aa[1+9][8] = 1.22893663194444454e+01;
      aa[1+9][9] = -7.12610918209876432e-01;
      aa[1+9][10] = 2.96585648148148077e-02;
      aa[1+9][11] = -8.39120370370370280e-04;
      aa[1+9][12] = 1.44675925925925915e-05;
      aa[1+9][13] = -1.14822163433274534e-07;

      aa[1+10][0] = -1.00793340050072246e+06;
      aa[1+10][1] = 1.25365357375546545e+06;
      aa[1+10][2] = -7.17496977671681903e+05;
      aa[1+10][3] = 2.50197799148019491e+05;
      aa[1+10][4] = -5.93119502234439133e+04;
      aa[1+10][5] = 1.00948122077546304e+04;
      aa[1+10][6] = -1.26920785108024666e+03;
      aa[1+10][7] = 1.19369888117283921e+02;
      aa[1+10][8] = -8.39929108796296120e+00;
      aa[1+10][9] = 4.36758937757201593e-01;
      aa[1+10][10] = -1.63162294238683135e-02;
      aa[1+10][11] = 4.14737654320987620e-04;
      aa[1+10][12] = -6.43004115226337266e-06;
      aa[1+10][13] = 4.59288653733098072e-08;

      aa[1+11][0] = 1.01008896107399475e+06;
      aa[1+11][1] = -1.13128194446919998e+06;
      aa[1+11][2] = 5.83376941359953489e+05;
      aa[1+11][3] = -1.83426840529192385e+05;
      aa[1+11][4] = 3.92391042486496808e+04;
      aa[1+11][5] = -6.03172397858796103e+03;
      aa[1+11][6] = 6.85523807870370206e+02;
      aa[1+11][7] = -5.83329899691357880e+01;
      aa[1+11][8] = 3.71681423611111050e+00;
      aa[1+11][9] = -1.75165573559670718e-01;
      aa[1+11][10] = 5.93557098765431883e-03;
      aa[1+11][11] = -1.36959876543209843e-04;
      aa[1+11][12] = 1.92901234567901154e-06;
      aa[1+11][13] = -1.25260541927208568e-08;

      aa[1+12][0] = -5.53480842562368838e+05;
      aa[1+12][1] = 5.62585342803527135e+05;
      aa[1+12][2] = -2.63556702276409895e+05;
      aa[1+12][3] = 7.53584394708075852e+04;
      aa[1+12][4] = -1.46744957513503032e+04;
      aa[1+12][5] = 2.05531602141203621e+03;
      aa[1+12][6] = -2.13036192129629569e+02;
      aa[1+12][7] = 1.65470100308641932e+01;
      aa[1+12][8] = -9.63185763888888546e-01;
      aa[1+12][9] = 4.15010931069958663e-02;
      aa[1+12][10] = -1.28665123456790089e-03;
      aa[1+12][11] = 2.71815375982042611e-05;
      aa[1+12][12] = -3.50729517396184110e-07;
      aa[1+12][13] = 2.08767569878680919e-09;

      aa[1+13][0] = 1.27463003376212277e+05;
      aa[1+13][1] = -1.18358503135054270e+05;
      aa[1+13][2] = 5.07250727721661024e+04;
      aa[1+13][3] = -1.32851381069958843e+04;
      aa[1+13][4] = 2.37234609053497979e+03;
      aa[1+13][5] = -3.05015925925925899e+02;
      aa[1+13][6] = 2.90491358024691309e+01;
      aa[1+13][7] = -2.07493827160493804e+00;
      aa[1+13][8] = 1.11157407407407399e-01;
      aa[1+13][9] = -4.41100823045267442e-03;
      aa[1+13][10] = 1.26028806584362106e-04;
      aa[1+13][11] = -2.45510662177328792e-06;
      aa[1+13][12] = 2.92274597830153370e-08;
      aa[1+13][13] = -1.60590438368216108e-10;
      break;
  default:
      cerr << "B-spline order " << ORDER << " is not implemented" << endl;
      exit(1);
  }
}

template <typename VALUETYPE, int ORDER>
void
CardinalBSpline<VALUETYPE, ORDER>::
init_deriv_coeffs () 
{
  switch (ORDER){
  case 2:

      dd[1+0][0] = 1.00000000000000000e+00;

      dd[1+1][0] = -1.00000000000000000e+00;

      break;
  case 3:
      dd[1+0][0] = 0.00000000000000000000000000000000e+00;
      dd[1+0][1] = 1.00000000000000000000000000000000e+00;

      dd[1+1][0] = 3.00000000000000000000000000000000e+00;
      dd[1+1][1] = -2.00000000000000000000000000000000e+00;

      dd[1+2][0] = -3.00000000000000000000000000000000e+00;
      dd[1+2][1] = 1.00000000000000000000000000000000e+00;
      break;

  case 4:

      dd[1+0][0] = 0.00000000000000000e+00;
      dd[1+0][1] = 0.00000000000000000e+00;
      dd[1+0][2] = 5.00000000000000000e-01;

      dd[1+1][0] = -2.00000000000000000e+00;
      dd[1+1][1] = 4.00000000000000000e+00;
      dd[1+1][2] = -1.50000000000000000e+00;

      dd[1+2][0] = 1.00000000000000000e+01;
      dd[1+2][1] = -8.00000000000000000e+00;
      dd[1+2][2] = 1.50000000000000000e+00;

      dd[1+3][0] = -8.00000000000000000e+00;
      dd[1+3][1] = 4.00000000000000000e+00;
      dd[1+3][2] = -5.00000000000000000e-01;

      break;
  case 6:

      dd[1+0][0] = 0.00000000000000000e+00;
      dd[1+0][1] = 0.00000000000000000e+00;
      dd[1+0][2] = 0.00000000000000000e+00;
      dd[1+0][3] = 0.00000000000000000e+00;
      dd[1+0][4] = 4.16666666666666644e-02;

      dd[1+1][0] = -2.49999999999999972e-01;
      dd[1+1][1] = 1.00000000000000000e+00;
      dd[1+1][2] = -1.50000000000000000e+00;
      dd[1+1][3] = 1.00000000000000000e+00;
      dd[1+1][4] = -2.08333333333333315e-01;

      dd[1+2][0] = 9.75000000000000000e+00;
      dd[1+2][1] = -1.90000000000000000e+01;
      dd[1+2][2] = 1.35000000000000000e+01;
      dd[1+2][3] = -4.00000000000000000e+00;
      dd[1+2][4] = 4.16666666666666741e-01;

      dd[1+3][0] = -5.77500000000000000e+01;
      dd[1+3][1] = 7.10000000000000000e+01;
      dd[1+3][2] = -3.15000000000000000e+01;
      dd[1+3][3] = 6.00000000000000000e+00;
      dd[1+3][4] = -4.16666666666666741e-01;

      dd[1+4][0] = 1.02249999999999986e+02;
      dd[1+4][1] = -8.90000000000000000e+01;
      dd[1+4][2] = 2.85000000000000000e+01;
      dd[1+4][3] = -3.99999999999999956e+00;
      dd[1+4][4] = 2.08333333333333315e-01;

      dd[1+5][0] = -5.39999999999999858e+01;
      dd[1+5][1] = 3.60000000000000000e+01;
      dd[1+5][2] = -9.00000000000000000e+00;
      dd[1+5][3] = 9.99999999999999889e-01;
      dd[1+5][4] = -4.16666666666666644e-02;

      break;
  case 8:

      dd[1+0][0] = 0.00000000000000000e+00;
      dd[1+0][1] = 0.00000000000000000e+00;
      dd[1+0][2] = 0.00000000000000000e+00;
      dd[1+0][3] = 0.00000000000000000e+00;
      dd[1+0][4] = 0.00000000000000000e+00;
      dd[1+0][5] = 0.00000000000000000e+00;
      dd[1+0][6] = 1.38888888888888873e-03;

      dd[1+1][0] = -1.11111111111111081e-02;
      dd[1+1][1] = 6.66666666666666657e-02;
      dd[1+1][2] = -1.66666666666666657e-01;
      dd[1+1][3] = 2.22222222222222210e-01;
      dd[1+1][4] = -1.66666666666666630e-01;
      dd[1+1][5] = 6.66666666666666519e-02;
      dd[1+1][6] = -9.72222222222222064e-03;

      dd[1+2][0] = 2.47777777777777786e+00;
      dd[1+2][1] = -7.39999999999999947e+00;
      dd[1+2][2] = 9.16666666666666607e+00;
      dd[1+2][3] = -6.00000000000000000e+00;
      dd[1+2][4] = 2.16666666666666652e+00;
      dd[1+2][5] = -3.99999999999999911e-01;
      dd[1+2][6] = 2.91666666666666671e-02;

      dd[1+3][0] = -5.42222222222222285e+01;
      dd[1+3][1] = 1.06000000000000000e+02;
      dd[1+3][2] = -8.53333333333333286e+01;
      dd[1+3][3] = 3.59999999999999929e+01;
      dd[1+3][4] = -8.33333333333333215e+00;
      dd[1+3][5] = 1.00000000000000000e+00;
      dd[1+3][6] = -4.86111111111111049e-02;

      dd[1+4][0] = 3.44000000000000057e+02;
      dd[1+4][1] = -4.91333333333333371e+02;
      dd[1+4][2] = 2.88000000000000000e+02;
      dd[1+4][3] = -8.84444444444444429e+01;
      dd[1+4][4] = 1.50000000000000000e+01;
      dd[1+4][5] = -1.33333333333333326e+00;
      dd[1+4][6] = 4.86111111111111049e-02;

      dd[1+5][0] = -8.71277777777777601e+02;
      dd[1+5][1] = 9.66999999999999886e+02;
      dd[1+5][2] = -4.41166666666666629e+02;
      dd[1+5][3] = 1.05999999999999986e+02;
      dd[1+5][4] = -1.41666666666666643e+01;
      dd[1+5][5] = 9.99999999999999778e-01;
      dd[1+5][6] = -2.91666666666666671e-02;

      dd[1+6][0] = 9.43122222222222035e+02;
      dd[1+6][1] = -8.47399999999999864e+02;
      dd[1+6][2] = 3.14833333333333258e+02;
      dd[1+6][3] = -6.19999999999999858e+01;
      dd[1+6][4] = 6.83333333333333215e+00;
      dd[1+6][5] = -3.99999999999999911e-01;
      dd[1+6][6] = 9.72222222222222064e-03;

      dd[1+7][0] = -3.64088888888888846e+02;
      dd[1+7][1] = 2.73066666666666606e+02;
      dd[1+7][2] = -8.53333333333333144e+01;
      dd[1+7][3] = 1.42222222222222214e+01;
      dd[1+7][4] = -1.33333333333333304e+00;
      dd[1+7][5] = 6.66666666666666519e-02;
      dd[1+7][6] = -1.38888888888888873e-03;

      break;
  case 10:

      dd[1+0][0] = 0.00000000000000000e+00;
      dd[1+0][1] = 0.00000000000000000e+00;
      dd[1+0][2] = 0.00000000000000000e+00;
      dd[1+0][3] = 0.00000000000000000e+00;
      dd[1+0][4] = 0.00000000000000000e+00;
      dd[1+0][5] = 0.00000000000000000e+00;
      dd[1+0][6] = 0.00000000000000000e+00;
      dd[1+0][7] = 0.00000000000000000e+00;
      dd[1+0][8] = 2.48015873015872948e-05;

      dd[1+1][0] = -2.48015873015873002e-04;
      dd[1+1][1] = 1.98412698412698402e-03;
      dd[1+1][2] = -6.94444444444444406e-03;
      dd[1+1][3] = 1.38888888888888846e-02;
      dd[1+1][4] = -1.73611111111111119e-02;
      dd[1+1][5] = 1.38888888888888846e-02;
      dd[1+1][6] = -6.94444444444444232e-03;
      dd[1+1][7] = 1.98412698412698358e-03;
      dd[1+1][8] = -2.23214285714285653e-04;

      dd[1+2][0] = 2.85466269841269826e-01;
      dd[1+2][1] = -1.14087301587301559e+00;
      dd[1+2][2] = 1.99305555555555536e+00;
      dd[1+2][3] = -1.98611111111111094e+00;
      dd[1+2][4] = 1.23263888888888862e+00;
      dd[1+2][5] = -4.86111111111111105e-01;
      dd[1+2][6] = 1.18055555555555525e-01;
      dd[1+2][7] = -1.58730158730158687e-02;
      dd[1+2][8] = 8.92857142857142612e-04;

      dd[1+3][0] = -1.92413194444444464e+01;
      dd[1+3][1] = 5.09305555555555571e+01;
      dd[1+3][2] = -5.87569444444444429e+01;
      dd[1+3][3] = 3.85138888888888857e+01;
      dd[1+3][4] = -1.56423611111111107e+01;
      dd[1+3][5] = 4.01388888888888840e+00;
      dd[1+3][6] = -6.31944444444444309e-01;
      dd[1+3][7] = 5.55555555555555525e-02;
      dd[1+3][8] = -2.08333333333333287e-03;

      dd[1+4][0] = 3.22092013888888857e+02;
      dd[1+4][1] = -6.31736111111111086e+02;
      dd[1+4][2] = 5.38576388888888914e+02;
      dd[1+4][3] = -2.60152777777777771e+02;
      dd[1+4][4] = 7.76909722222222143e+01;
      dd[1+4][5] = -1.46527777777777786e+01;
      dd[1+4][6] = 1.70138888888888862e+00;
      dd[1+4][7] = -1.11111111111111105e-01;
      dd[1+4][8] = 3.12499999999999974e-03;

      dd[1+5][0] = -2.11931423611111086e+03;
      dd[1+5][1] = 3.27451388888888869e+03;
      dd[1+5][2] = -2.19579861111111040e+03;
      dd[1+5][3] = 8.33597222222222172e+02;
      dd[1+5][4] = -1.95746527777777743e+02;
      dd[1+5][5] = 2.90972222222222214e+01;
      dd[1+5][6] = -2.67361111111111072e+00;
      dd[1+5][7] = 1.38888888888888867e-01;
      dd[1+5][8] = -3.12499999999999974e-03;

      dd[1+6][0] = 6.62868576388888869e+03;
      dd[1+6][1] = -8.38948611111111131e+03;
      dd[1+6][2] = 4.60820138888888960e+03;
      dd[1+6][3] = -1.43440277777777760e+03;
      dd[1+6][4] = 2.76753472222222229e+02;
      dd[1+6][5] = -3.39027777777777786e+01;
      dd[1+6][6] = 2.57638888888888884e+00;
      dd[1+6][7] = -1.11111111111111091e-01;
      dd[1+6][8] = 2.08333333333333287e-03;

      dd[1+7][0] = -1.05284600694444416e+04;
      dd[1+7][1] = 1.12186805555555547e+04;
      dd[1+7][2] = -5.19588194444444343e+03;
      dd[1+7][3] = 1.36676388888888869e+03;
      dd[1+7][4] = -2.23454861111111086e+02;
      dd[1+7][5] = 2.32638888888888857e+01;
      dd[1+7][6] = -1.50694444444444398e+00;
      dd[1+7][7] = 5.55555555555555386e-02;
      dd[1+7][8] = -8.92857142857142612e-04;

      dd[1+8][0] = 8.19611135912698228e+03;
      dd[1+8][1] = -7.50589087301587188e+03;
      dd[1+8][2] = 2.99611805555555520e+03;
      dd[1+8][3] = -6.81236111111110858e+02;
      dd[1+8][4] = 9.65451388888888715e+01;
      dd[1+8][5] = -8.73611111111110894e+00;
      dd[1+8][6] = 4.93055555555555358e-01;
      dd[1+8][7] = -1.58730158730158687e-02;
      dd[1+8][8] = 2.23214285714285653e-04;

      dd[1+9][0] = -2.48015873015873058e+03;
      dd[1+9][1] = 1.98412698412698387e+03;
      dd[1+9][2] = -6.94444444444444343e+02;
      dd[1+9][3] = 1.38888888888888857e+02;
      dd[1+9][4] = -1.73611111111111107e+01;
      dd[1+9][5] = 1.38888888888888884e+00;
      dd[1+9][6] = -6.94444444444444198e-02;
      dd[1+9][7] = 1.98412698412698402e-03;
      dd[1+9][8] = -2.48015873015872948e-05;

      break;
  case 12:

      dd[1+0][0] = 0.00000000000000000e+00;
      dd[1+0][1] = 0.00000000000000000e+00;
      dd[1+0][2] = 0.00000000000000000e+00;
      dd[1+0][3] = 0.00000000000000000e+00;
      dd[1+0][4] = 0.00000000000000000e+00;
      dd[1+0][5] = 0.00000000000000000e+00;
      dd[1+0][6] = 0.00000000000000000e+00;
      dd[1+0][7] = 0.00000000000000000e+00;
      dd[1+0][8] = 0.00000000000000000e+00;
      dd[1+0][9] = 0.00000000000000000e+00;
      dd[1+0][10] = 2.75573192239858830e-07;

      dd[1+1][0] = -3.30687830687830575e-06;
      dd[1+1][1] = 3.30687830687830575e-05;
      dd[1+1][2] = -1.48809523809523742e-04;
      dd[1+1][3] = 3.96825396825396717e-04;
      dd[1+1][4] = -6.94444444444444363e-04;
      dd[1+1][5] = 8.33333333333333170e-04;
      dd[1+1][6] = -6.94444444444444471e-04;
      dd[1+1][7] = 3.96825396825396717e-04;
      dd[1+1][8] = -1.48809523809523769e-04;
      dd[1+1][9] = 3.30687830687830642e-05;
      dd[1+1][10] = -3.03130511463844708e-06;

      dd[1+2][0] = 1.86210317460317396e-02;
      dd[1+2][1] = -9.30886243386243317e-02;
      dd[1+2][2] = 2.09374999999999978e-01;
      dd[1+2][3] = -2.78968253968253921e-01;
      dd[1+2][4] = 2.43749999999999939e-01;
      dd[1+2][5] = -1.45833333333333287e-01;
      dd[1+2][6] = 6.04166666666666463e-02;
      dd[1+2][7] = -1.70634920634920619e-02;
      dd[1+2][8] = 3.12499999999999931e-03;
      dd[1+2][9] = -3.30687830687830561e-04;
      dd[1+2][10] = 1.51565255731922366e-05;

      dd[1+3][0] = -3.56128968253968159e+00;
      dd[1+3][1] = 1.18399470899470884e+01;
      dd[1+3][2] = -1.76901785714285680e+01;
      dd[1+3][3] = 1.56317460317460295e+01;
      dd[1+3][4] = -9.03749999999999787e+00;
      dd[1+3][5] = 3.56666666666666599e+00;
      dd[1+3][6] = -9.70833333333333437e-01;
      dd[1+3][7] = 1.79365079365079338e-01;
      dd[1+3][8] = -2.14285714285714218e-02;
      dd[1+3][9] = 1.48809523809523801e-03;
      dd[1+3][10] = -4.54695767195767116e-05;

      dd[1+4][0] = 1.39473630952380915e+02;
      dd[1+4][1] = -3.45747354497354422e+02;
      dd[1+4][2] = 3.84595535714285688e+02;
      dd[1+4][3] = -2.52558730158730128e+02;
      dd[1+4][4] = 1.08295833333333320e+02;
      dd[1+4][5] = -3.16333333333333329e+01;
      dd[1+4][6] = 6.36249999999999893e+00;
      dd[1+4][7] = -8.68253968253968167e-01;
      dd[1+4][8] = 7.67857142857142766e-02;
      dd[1+4][9] = -3.96825396825396803e-03;
      dd[1+4][10] = 9.09391534391534233e-05;

      dd[1+5][0] = -1.99191277777777759e+03;
      dd[1+5][1] = 3.91702546296296259e+03;
      dd[1+5][2] = -3.45189999999999964e+03;
      dd[1+5][3] = 1.79357222222222254e+03;
      dd[1+5][4] = -6.07849999999999909e+02;
      dd[1+5][5] = 1.40241666666666674e+02;
      dd[1+5][6] = -2.22833333333333350e+01;
      dd[1+5][7] = 2.40555555555555545e+00;
      dd[1+5][8] = -1.68750000000000011e-01;
      dd[1+5][9] = 6.94444444444444493e-03;
      dd[1+5][10] = -1.27314814814814803e-04;

      dd[1+6][0] = 1.34045672222222202e+04;
      dd[1+6][1] = -2.17437745370370394e+04;
      dd[1+6][2] = 1.57936999999999971e+04;
      dd[1+6][3] = -6.76002777777777828e+03;
      dd[1+6][4] = 1.88694999999999959e+03;
      dd[1+6][5] = -3.58718333333333248e+02;
      dd[1+6][6] = 4.70166666666666657e+01;
      dd[1+6][7] = -4.19444444444444464e+00;
      dd[1+6][8] = 2.43749999999999939e-01;
      dd[1+6][9] = -8.33333333333333322e-03;
      dd[1+6][10] = 1.27314814814814803e-04;

      dd[1+7][0] = -4.82467768055555425e+04;
      dd[1+7][1] = 6.63295740740740730e+04;
      dd[1+7][2] = -4.08248812500000058e+04;
      dd[1+7][3] = 1.48089555555555544e+04;
      dd[1+7][4] = -3.50529583333333358e+03;
      dd[1+7][5] = 5.65666666666666742e+02;
      dd[1+7][6] = -6.30291666666666757e+01;
      dd[1+7][7] = 4.78888888888888875e+00;
      dd[1+7][8] = -2.37499999999999961e-01;
      dd[1+7][9] = 6.94444444444444406e-03;
      dd[1+7][10] = -9.09391534391534233e-05;

      dd[1+8][0] = 9.82209819246031839e+04;
      dd[1+8][1] = -1.16755124338624330e+05;
      dd[1+8][2] = 6.21602616071428638e+04;
      dd[1+8][3] = -1.95194253968253979e+04;
      dd[1+8][4] = 4.00403749999999945e+03;
      dd[1+8][5] = -5.60733333333333348e+02;
      dd[1+8][6] = 5.43041666666666600e+01;
      dd[1+8][7] = -3.59206349206349174e+00;
      dd[1+8][8] = 1.55357142857142833e-01;
      dd[1+8][9] = -3.96825396825396803e-03;
      dd[1+8][10] = 4.54695767195767116e-05;

      dd[1+9][0] = -1.13169165843253970e+05;
      dd[1+9][1] = 1.18122817625661366e+05;
      dd[1+9][2] = -5.52787093749999985e+04;
      dd[1+9][3] = 1.52773067460317416e+04;
      dd[1+9][4] = -2.76199374999999918e+03;
      dd[1+9][5] = 3.41404166666666640e+02;
      dd[1+9][6] = -2.92270833333333258e+01;
      dd[1+9][7] = 1.71150793650793598e+00;
      dd[1+9][8] = -6.56249999999999889e-02;
      dd[1+9][9] = 1.48809523809523758e-03;
      dd[1+9][10] = -1.51565255731922366e-05;

      dd[1+10][0] = 6.87091410350528895e+04;
      dd[1+10][1] = -6.37554892526454933e+04;
      dd[1+10][2] = 2.65665287202380860e+04;
      dd[1+10][3] = -6.54809007936507714e+03;
      dd[1+10][4] = 1.05745069444444425e+03;
      dd[1+10][5] = -1.16929166666666646e+02;
      dd[1+10][6] = 8.96736111111111001e+00;
      dd[1+10][7] = -4.71031746031745857e-01;
      dd[1+10][8] = 1.62202380952380931e-02;
      dd[1+10][9] = -3.30687830687830724e-04;
      dd[1+10][10] = 3.03130511463844708e-06;

      dd[1+11][0] = -1.70627657142857133e+04;
      dd[1+11][1] = 1.42189714285714290e+04;
      dd[1+11][2] = -5.33211428571428587e+03;
      dd[1+11][3] = 1.18491428571428560e+03;
      dd[1+11][4] = -1.72800000000000011e+02;
      dd[1+11][5] = 1.72800000000000011e+01;
      dd[1+11][6] = -1.19999999999999973e+00;
      dd[1+11][7] = 5.71428571428571341e-02;
      dd[1+11][8] = -1.78571428571428544e-03;
      dd[1+11][9] = 3.30687830687830710e-05;
      dd[1+11][10] = -2.75573192239858830e-07;

      break;
  case 14:

      dd[1+0][0] = 0.00000000000000000e+00;
      dd[1+0][1] = 0.00000000000000000e+00;
      dd[1+0][2] = 0.00000000000000000e+00;
      dd[1+0][3] = 0.00000000000000000e+00;
      dd[1+0][4] = 0.00000000000000000e+00;
      dd[1+0][5] = 0.00000000000000000e+00;
      dd[1+0][6] = 0.00000000000000000e+00;
      dd[1+0][7] = 0.00000000000000000e+00;
      dd[1+0][8] = 0.00000000000000000e+00;
      dd[1+0][9] = 0.00000000000000000e+00;
      dd[1+0][10] = 0.00000000000000000e+00;
      dd[1+0][11] = 0.00000000000000000e+00;
      dd[1+0][12] = 2.08767569878680919e-09;

      dd[1+1][0] = -2.92274597830153270e-08;
      dd[1+1][1] = 3.50729517396183951e-07;
      dd[1+1][2] = -1.92901234567901197e-06;
      dd[1+1][3] = 6.43004115226337266e-06;
      dd[1+1][4] = -1.44675925925925898e-05;
      dd[1+1][5] = 2.31481481481481368e-05;
      dd[1+1][6] = -2.70061728395061675e-05;
      dd[1+1][7] = 2.31481481481481436e-05;
      dd[1+1][8] = -1.44675925925925881e-05;
      dd[1+1][9] = 6.43004115226337266e-06;
      dd[1+1][10] = -1.92901234567901154e-06;
      dd[1+1][11] = 3.50729517396184004e-07;
      dd[1+1][12] = -2.71397840842285203e-08;

      dd[1+2][0] = 7.78122661803217169e-04;
      dd[1+2][1] = -4.66856060606060577e-03;
      dd[1+2][2] = 1.28375771604938224e-02;
      dd[1+2][3] = -2.13927469135802434e-02;
      dd[1+2][4] = 2.40596064814814770e-02;
      dd[1+2][5] = -1.92361111111111066e-02;
      dd[1+2][6] = 1.12075617283950591e-02;
      dd[1+2][7] = -4.79166666666666630e-03;
      dd[1+2][8] = 1.49016203703703680e-03;
      dd[1+2][9] = -3.27932098765432048e-04;
      dd[1+2][10] = 4.82253086419752924e-05;
      dd[1+2][11] = -4.20875420875420762e-06;
      dd[1+2][12] = 1.62838704505371148e-07;

      dd[1+3][0] = -4.03071309156378454e-01;
      dd[1+3][1] = 1.61072916666666588e+00;
      dd[1+3][2] = -2.94872492283950560e+00;
      dd[1+3][3] = 3.26923225308641907e+00;
      dd[1+3][4] = -2.44390914351851762e+00;
      dd[1+3][5] = 1.29701388888888869e+00;
      dd[1+3][6] = -5.00667438271604870e-01;
      dd[1+3][7] = 1.41458333333333297e-01;
      dd[1+3][8] = -2.89785879629629595e-02;
      dd[1+3][9] = 4.18595679012345560e-03;
      dd[1+3][10] = -4.03163580246913454e-04;
      dd[1+3][11] = 2.31481481481481436e-05;
      dd[1+3][12] = -5.97075249853027473e-07;

      dd[1+4][0] = 3.46573402134773545e+01;
      dd[1+4][1] = -1.03570505401234541e+02;
      dd[1+4][2] = 1.41675472608024648e+02;
      dd[1+4][3] = -1.17250932355967066e+02;
      dd[1+4][4] = 6.53486834490740591e+01;
      dd[1+4][5] = -2.58200231481481417e+01;
      dd[1+4][6] = 7.40846836419752997e+00;
      dd[1+4][7] = -1.55335648148148131e+00;
      dd[1+4][8] = 2.35836226851851821e-01;
      dd[1+4][9] = -2.52379115226337367e-02;
      dd[1+4][10] = 1.80362654320987618e-03;
      dd[1+4][11] = -7.71604938271604787e-05;
      dd[1+4][12] = 1.49268812463256890e-06;

      dd[1+5][0] = -9.85734932484567594e+02;
      dd[1+5][1] = 2.34537094907407391e+03;
      dd[1+5][2] = -2.55216012731481442e+03;
      dd[1+5][3] = 1.67863946759259215e+03;
      dd[1+5][4] = -7.42801996527777533e+02;
      dd[1+5][5] = 2.32788194444444429e+02;
      dd[1+5][6] = -5.29334490740740691e+01;
      dd[1+5][7] = 8.79097222222221930e+00;
      dd[1+5][8] = -1.05720486111111089e+00;
      dd[1+5][9] = 8.96990740740740561e-02;
      dd[1+5][10] = -5.09259259259259214e-03;
      dd[1+5][11] = 1.73611111111111091e-04;
      dd[1+5][12] = -2.68683862433862405e-06;

      dd[1+6][0] = 1.26611450675154301e+04;
      dd[1+6][1] = -2.49483890509259181e+04;
      dd[1+6][2] = 2.24671198726851835e+04;
      dd[1+6][3] = -1.22209605324074037e+04;
      dd[1+6][4] = 4.46954800347222226e+03;
      dd[1+6][5] = -1.15717180555555569e+03;
      dd[1+6][6] = 2.17336550925925877e+02;
      dd[1+6][7] = -2.98190277777777730e+01;
      dd[1+6][8] = 2.96467013888888786e+00;
      dd[1+6][9] = -2.08217592592592537e-01;
      dd[1+6][10] = 9.80324074074074084e-03;
      dd[1+6][11] = -2.77777777777777723e-04;
      dd[1+6][12] = 3.58245149911816569e-06;

      dd[1+7][0] = -8.65103350983796117e+04;
      dd[1+7][1] = 1.45059862662036991e+05;
      dd[1+7][2] = -1.11110792187499988e+05;
      dd[1+7][3] = 5.13875690200617100e+04;
      dd[1+7][4] = -1.59760507812499945e+04;
      dd[1+7][5] = 3.51610791666666591e+03;
      dd[1+7][6] = -5.61543402777777828e+02;
      dd[1+7][7] = 6.55540277777777760e+01;
      dd[1+7][8] = -5.55078125000000000e+00;
      dd[1+7][9] = 3.32445987654320985e-01;
      dd[1+7][10] = -1.33680555555555566e-02;
      dd[1+7][11] = 3.24074074074074065e-04;
      dd[1+7][12] = -3.58245149911816569e-06;

      dd[1+8][0] = 3.44312001691743673e+05;
      dd[1+8][1] = -5.01173642523147981e+05;
      dd[1+8][2] = 3.33174742627314758e+05;
      dd[1+8][3] = -1.33731403819444415e+05;
      dd[1+8][4] = 3.60886603298611008e+04;
      dd[1+8][5] = -6.89683430555555333e+03;
      dd[1+8][6] = 9.57010671296296209e+02;
      dd[1+8][7] = -9.71481944444444423e+01;
      dd[1+8][8] = 7.16032986111111214e+00;
      dd[1+8][9] = -3.73726851851851838e-01;
      dd[1+8][10] = 1.31134259259259225e-02;
      dd[1+8][11] = -2.77777777777777723e-04;
      dd[1+8][12] = 2.68683862433862405e-06;

      dd[1+9][0] = -8.36109800730131101e+05;
      dd[1+9][1] = 1.07272209403935168e+06;
      dd[1+9][2] = -6.28650429716435261e+05;
      dd[1+9][3] = 2.22500141493055620e+05;
      dd[1+9][4] = -5.29692259982638934e+04;
      dd[1+9][5] = 8.93567881944444343e+03;
      dd[1+9][6] = -1.09535214120370392e+03;
      dd[1+9][7] = 9.83149305555555628e+01;
      dd[1+9][8] = -6.41349826388888822e+00;
      dd[1+9][9] = 2.96585648148148084e-01;
      dd[1+9][10] = -9.23032407407407308e-03;
      dd[1+9][11] = 1.73611111111111091e-04;
      dd[1+9][12] = -1.49268812463256890e-06;

      dd[1+10][0] = 1.25365357375546545e+06;
      dd[1+10][1] = -1.43499395534336381e+06;
      dd[1+10][2] = 7.50593397444058442e+05;
      dd[1+10][3] = -2.37247800893775653e+05;
      dd[1+10][4] = 5.04740610387731504e+04;
      dd[1+10][5] = -7.61524710648147993e+03;
      dd[1+10][6] = 8.35589216820987417e+02;
      dd[1+10][7] = -6.71943287037036896e+01;
      dd[1+10][8] = 3.93083043981481417e+00;
      dd[1+10][9] = -1.63162294238683142e-01;
      dd[1+10][10] = 4.56211419753086399e-03;
      dd[1+10][11] = -7.71604938271604787e-05;
      dd[1+10][12] = 5.97075249853027473e-07;

      dd[1+11][0] = -1.13128194446919998e+06;
      dd[1+11][1] = 1.16675388271990698e+06;
      dd[1+11][2] = -5.50280521587577183e+05;
      dd[1+11][3] = 1.56956416994598723e+05;
      dd[1+11][4] = -3.01586198929398051e+04;
      dd[1+11][5] = 4.11314284722222146e+03;
      dd[1+11][6] = -4.08330929783950523e+02;
      dd[1+11][7] = 2.97345138888888840e+01;
      dd[1+11][8] = -1.57649016203703640e+00;
      dd[1+11][9] = 5.93557098765431917e-02;
      dd[1+11][10] = -1.50655864197530827e-03;
      dd[1+11][11] = 2.31481481481481368e-05;
      dd[1+11][12] = -1.62838704505371148e-07;

      dd[1+12][0] = 5.62585342803527135e+05;
      dd[1+12][1] = -5.27113404552819789e+05;
      dd[1+12][2] = 2.26075318412422756e+05;
      dd[1+12][3] = -5.86979830054012127e+04;
      dd[1+12][4] = 1.02765801070601810e+04;
      dd[1+12][5] = -1.27821715277777730e+03;
      dd[1+12][6] = 1.15829070216049359e+02;
      dd[1+12][7] = -7.70548611111110837e+00;
      dd[1+12][8] = 3.73509837962962776e-01;
      dd[1+12][9] = -1.28665123456790098e-02;
      dd[1+12][10] = 2.98996913580246875e-04;
      dd[1+12][11] = -4.20875420875420932e-06;
      dd[1+12][12] = 2.71397840842285203e-08;

      dd[1+13][0] = -1.18358503135054270e+05;
      dd[1+13][1] = 1.01450145544332205e+05;
      dd[1+13][2] = -3.98554143209876493e+04;
      dd[1+13][3] = 9.48938436213991918e+03;
      dd[1+13][4] = -1.52507962962962938e+03;
      dd[1+13][5] = 1.74294814814814799e+02;
      dd[1+13][6] = -1.45245679012345654e+01;
      dd[1+13][7] = 8.89259259259259194e-01;
      dd[1+13][8] = -3.96990740740740672e-02;
      dd[1+13][9] = 1.26028806584362095e-03;
      dd[1+13][10] = -2.70061728395061675e-05;
      dd[1+13][11] = 3.50729517396184057e-07;
      dd[1+13][12] = -2.08767569878680919e-09;
      break;
  default:
      cerr << "B-spline order " << ORDER << " is not implemented" << endl;
      exit(1);
  }
}
